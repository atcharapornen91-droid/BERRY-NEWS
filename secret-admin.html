<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>üß† ‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏±‡∏ö‡∏ü‡∏µ‡πÇ‡∏≠‡∏ô‡πà‡∏≤ | Berry News üçì</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

<style>
body {
  font-family: Inter, sans-serif;
  background:#1F2328;
  color:#EAEAEA;
  margin:0;
}

main {
  max-width:800px;
  margin:3rem auto;
  padding:0 1.5rem;
}

h1 {
  font-family:'Playfair Display', serif;
  margin-bottom:1.5rem;
}

.topbar {
  display:flex;
  justify-content:space-between;
  margin-bottom:2rem;
}

.topbar a, .topbar button {
  background:none;
  border:none;
  color:#AAA;
  font-size:0.8rem;
  cursor:pointer;
  text-decoration:none;
}

.card {
  background:#2B2F36;
  padding:1.2rem;
  border-radius:14px;
  margin-bottom:1rem;
}

small {
  color:#AAA;
  font-size:0.75rem;
}

.actions {
  margin-top:0.8rem;
}

.actions button {
  margin-right:0.4rem;
  padding:0.3rem 0.9rem;
  border-radius:20px;
  border:none;
  font-size:0.75rem;
  cursor:pointer;
}

.draft { background:#FFD6A5; color:#000; }
.public { background:#B7E4C7; color:#000; }
.delete { background:#FFADAD; color:#000; }

/* login */
.login {
  max-width:420px;
  margin:6rem auto;
  text-align:center;
}

.login input {
  width:100%;
  padding:0.7rem 1rem;
  border-radius:20px;
  border:none;
  margin-top:1rem;
}

.login button {
  margin-top:1rem;
  padding:0.5rem 1.4rem;
  border-radius:20px;
  border:none;
  background:#E8AEB7;
  cursor:pointer;
}

.error {
  margin-top:1rem;
  color:#ff9a9a;
  font-size:0.8rem;
}
</style>
</head>

<body>

<div id="app"></div>

<script>
const ADMIN_PASSWORD = "youcantkillfiona";
const app = document.getElementById("app");

// auto auth
if (sessionStorage.getItem("fionaAuth") === "true") {
  renderAdmin();
} else {
  renderLogin();
}

function renderLogin() {
  app.innerHTML = `
    <div class="login">
      <h1>üîê ‡∏ü‡∏µ‡πÇ‡∏≠‡∏ô‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</h1>
      <input type="password" id="password" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô">
      <button onclick="checkPassword()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <div class="error" id="error"></div>
    </div>
  `;
}

function checkPassword() {
  const pass = document.getElementById("password").value;
  if (pass === ADMIN_PASSWORD) {
    sessionStorage.setItem("fionaAuth", "true");
    renderAdmin();
  } else {
    document.getElementById("error").textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πâ‡∏≤";
  }
}

function logout(){
  sessionStorage.removeItem("fionaAuth");
  location.reload();
}

function renderAdmin() {
  let secrets = JSON.parse(localStorage.getItem("secretNews")) || [];
  let drafts  = JSON.parse(localStorage.getItem("draftNews"))  || [];
  let publics = JSON.parse(localStorage.getItem("publicNews")) || [];

  app.innerHTML = `
    <main>
      <div class="topbar">
        <a href="index.html">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <button onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>

      <h1>üß† ‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏±‡∏ö‡∏ñ‡∏∂‡∏á‡∏ü‡∏µ‡πÇ‡∏≠‡∏ô‡πà‡∏≤</h1>

      ${secrets.length === 0 
        ? "<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà ‚ú®</p>"
        : secrets.map((item,i)=>`
          <div class="card">
            <small>${item.time} | ${item.sender || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠"}</small>
            <p>${item.story}</p>

            <div class="actions">
              <button class="draft" onclick="toDraft(${i})">üìù Draft</button>
              <button class="public" onclick="toPublic(${i})">üöÄ Public</button>
              <button class="delete" onclick="removeItem(${i})">üóë ‡∏•‡∏ö</button>
            </div>
          </div>
        `).join("")
      }
    </main>
  `;

  window.toDraft = (i) => {
    drafts.push(secrets[i]);
    localStorage.setItem("draftNews", JSON.stringify(drafts));
    secrets.splice(i,1);
    save(secrets);
  };

  window.toPublic = (i) => {
    publics.push({
      ...secrets[i],
      reactions:{ laugh:0, fire:0, facepalm:0, skull:0 }
    });
    localStorage.setItem("publicNews", JSON.stringify(publics));
    secrets.splice(i,1);
    save(secrets);
  };

  window.removeItem = (i) => {
    secrets.splice(i,1);
    save(secrets);
  };

  function save(data){
    localStorage.setItem("secretNews", JSON.stringify(data));
    renderAdmin();
  }
}
</script>

</body>
</html>

